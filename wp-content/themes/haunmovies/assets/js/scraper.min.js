var $=jQuery.noConflict();$(document).ready(function(){$("<script>").on("load",function(){console.log("Successfully loaded lazysizes.min.js script.")}).prop("src",halim_scraper.lazysizes).each(function(){document.body.appendChild(this)}),$("#get-discover-data").click(function(){getDiscover()}),$("#get-trending-data").click(function(){getTrending()}),$("[name=site]").change(function(){"imdb"==$(this).val()?$(".media_type").hide():$(".media_type").show(),$("#s").focus()});var a=null;$("#s").keypress(function(b){var c=b.keyCode?b.keyCode:b.which;if(13==c)return getSearch(a),!1}),$("[name=media_type]").change(function(){getSearch(a,$(this).val())}),$("body").on("click",".pagination.search li a",function(){getSearch(a,null,$(this).data("page"))}),$("body").on("click",".pagination.trending li a",function(){getTrending($(this).data("page"))}),$("body").on("click",".pagination.discover li a",function(){getDiscover($(this).data("page"))})});function getSearch(a,b=null,c=""){clearTimeout(a);$(this);a=setTimeout(function(){var a=$("[name=s]").val(),b=$("[name=is_adult]:checked").val(),d=null==d?$("[name=media_type]:checked").val():d;$("#loading").removeClass("hidden"),a?$.ajax({type:"POST",url:halim_scraper.ajax_url,data:{action:"halim_tmdb_search_ajax",query:a,is_adult:b,media_type:d,page:c},success:function(a){$("#loading").addClass("hidden"),$("#results").html(a),$("#checkAll").click(function(){$("#results input:checkbox").not(this).prop("checked",this.checked)}),appendInput()}}):($("#results").text("The keyword can't be empty!"),$("#loading").addClass("hidden"))},100)}function getTrending(a=""){var b=$.map($("#trending-form option:selected"),function(a){return a.value});b.join(","),$.ajax({type:"POST",url:halim_scraper.ajax_url,data:{action:"halim_get_trending_data",values:b,page:a},success:function(a){$("#results").html(a),$("#checkAll").click(function(){$("#results input:checkbox").not(this).prop("checked",this.checked)}),appendInput()}})}function getDiscover(a=""){var b=$("#discover-form [name=language]").val(),c=$("[name=is_adult]:checked").val(),d=$("#discover-form [name=release_year]").val(),e=$.map($("#discover-form [name=discover_type] option:selected"),function(a){return a.value}),f=$.map($("#discover-form [name=sort_by] option:selected"),function(a){return a.value});f.join(","),$.ajax({type:"POST",url:halim_scraper.ajax_url,data:{action:"halim_ajax_discover",is_adult:c,sort_by:f,language:b,release_year:d,discover_type:e,page:a},success:function(a){$("#results").html(a),$("#checkAll").click(function(){$("#results input:checkbox").not(this).prop("checked",this.checked)}),appendInput()}})}function appendInput(){$(".post-meta span.name").on("input",function(){var a={},b=$(this).data("id");a.title=$(this).text(),a.tmdb_id=$(this).data("tmdb_id"),a.original_title=$(this).data("original_title"),a.media_type=$(this).data("media_type"),a.original_language=$(this).data("original_language"),a.first_air_date=$(this).data("first_air_date"),a.genre_ids=$(this).data("genre_ids"),a.release_date=$(this).data("release_date"),a.poster_image=$(this).data("poster_image"),$("#pid-"+b).val(JSON.stringify(a))}),$(".post-meta span.original-title").on("input",function(){var a={},b=$(this).data("id");a.title=$(this).data("title"),a.tmdb_id=$(this).data("tmdb_id"),a.original_title=$(this).text(),a.media_type=$(this).data("media_type"),a.original_language=$(this).data("original_language"),a.first_air_date=$(this).data("first_air_date"),a.genre_ids=$(this).data("genre_ids"),a.release_date=$(this).data("release_date"),a.poster_image=$(this).data("poster_image"),$("#pid-"+b).val(JSON.stringify(a))})}function setMessage(a){$("#message").html(a).show()}var check;$(".halim-wrap").on("click",function(){check=$("input[name=\"create_category\"]").is(":checked"),check?$("#list-cat").hide():$("#list-cat").show()});function CrawlData(){$("#halim_data_rebuild").prop("disabled",!0),setMessage("<p>Reading data...</p>");var movie_data=[];$(".list-movies [name=movie_data]:checked").each(function(a){movie_data[a]=btoa($(this).val())});var auto_create_category=$("[name=create_category]:checked").val(),save_poster=$("[name=save_poster]:checked").val();$.ajax({url:halim_scraper.ajax_url,type:"POST",data:"action=halim_data_crawler&do=getlist&movie_data=&auto_create_category="+auto_create_category+"&save_poster="+save_poster,success:function(result){function regenItem(){return i>=list.length?($("#halim_data_rebuild").prop("disabled",!1),$("#status p:first-child").addClass("ok"),void setMessage("Done!")):void(list[i].movie_data&&(setMessage("Rebuilding "+(i+1)+" of "+list.length+" ("+list[i].movie_data+")..."),$.ajax({url:halim_scraper.ajax_url,type:"POST",data:{action:"halim_data_crawler",do:"regen",movie_data:list[i].movie_data,auto_create_category:auto_create_category,save_poster:save_poster},success:function(a){++i,"-1"!=a&&$("#status").prepend("<p><span style=\"color:#46b450;font-size: 17px;font-weight: bold;\">\u2713</span> "+a+"</p>"),regenItem()}})))}var list=eval(result),i=0;return list?void(console.log(list),regenItem()):(setMessage("No data found."),void $("#halim_data_rebuild").prop("disabled",!1))},error:function(a){setMessage("Error!"+a.status)}})}