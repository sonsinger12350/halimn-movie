var $=jQuery.noConflict();function fastImport(){var e=$("#import-multi-episode").val().split(/\r?\n/);$("#result").show().html("Please wait..."),$.ajax({url:ajax_url,type:"POST",data:{action:"halim_ajax_fast_import_episode",post_id:post_id,server:server,list_link:e},success:function(e){$("#result").show().html('Import successfuly! <a href="?page=halim-episode-manager&act=edit_ep&post_id='+post_id+"&server="+server+'&episode=1&paged=1">Edit Episode</a>')}})}function setMessage(e){$("#message").html(e),$("#message").show()}function halim_ImportEPS(){$("#halim_data_rebuild").prop("disabled",!0),setMessage("Reading data...");var list_link=$("#import-multi-episode").val().split(/\r?\n/);$.ajax({url:ajax_url,type:"POST",data:"action=halim_ajax_import_episode&do=getList&list_link="+list_link+"&post_id="+post_id+"&server="+server,success:function(result){var list=eval(result),curr=0;if(!list)return setMessage("No data found!"),void $("#halim_data_rebuild").prop("disabled",!1);function pushItem(){if(curr>=list.length)return $("#halim_data_rebuild").prop("disabled",!1),$("#status p:first-child").addClass("ok"),void setMessage("Done!");setMessage("Importing "+(curr+1)+" of "+list.length+" (Episode "+list[curr].ep_name+")..."),$.ajax({url:ajax_url,type:"POST",data:{action:"halim_ajax_import_episode",do:"insertEpisode",post_id:post_id,server:server,ep_name:list[curr].ep_name,ep_link:list[curr].ep_link,ep_type:list[curr].ep_type},success:function(e){curr+=1,"-1"!=e&&$("#status").show().prepend('<p><span style="color:#46b450;font-size: 17px;font-weight: bold;">âœ“</span> '+e+"</p>"),pushItem()}})}pushItem()},error:function(e,s,i){setMessage("Error "+e.status)}})}jQuery(function(n){n(document).on("click","#add-new-eps",function(){var e=n(this).data("ep-total")+1;n(this).data("ep-total",e);var s=n(this).data("server"),e='<div class="halimmovies_episodes episodes_'+e+' row" data-ep="'+e+'" data-server="'+s+'"><div class="form-group col-lg-1" style="margin-right: -1px"><label for="halimmovies_ep_name_'+s+"_"+e+'">Episode Name</label><input id="halimmovies_ep_name_'+s+"_"+e+'" name="halimmovies_ep_name[]" type="text" class="form-control" value="'+e+'" placeholder="Episode name"></div><div class="form-group col-lg-1" style="margin-right: -1px"><label for="halimmovies_ep_slug_'+s+"_"+e+'">Episode Slug</label><input id="halimmovies_ep_slug" type="text" class="form-control" name="halimmovies_ep_slug[]" value="'+episode_slug_default+"-"+e+'" placeholder="Episode Slug"></div><div class="form-group col-lg-2" style="margin-right: -1px"><label>Type: </label><select name="halimmovies_ep_type[]" id="halimmovies_ep_type_'+s+"_"+e+'" style="display:block;width:100%;margin-top: 1px;height: 32px;">'+episode_type+'</select></div><div class="form-group col-lg-8"><label for="halimmovies_ep_link_'+s+"_"+e+'">Link: </label><input class="form-control" type="text" id="halimmovies_ep_link_'+s+"_"+e+'" name="halimmovies_ep_link[]" style="width:100%" value="" placeholder="Episode link"/></div><a class="del_ep"><span class="dashicons dashicons-no"></span></a><div class="clearfix"></div></div>';n("#halimmovies_episodes").append(e)}),n(document).on("click",".del_ep",function(){n(this).parent(".halimmovies_episodes").remove()});var t=current_subtitle_count-1;n(document).on("click",".add_new_sub",function(){var e=n(this).data("server"),s=n(this).data("ep"),i='<div class="halimmovies_subs" style="margin-bottom: 10px"><label>Label: </label> <input  type="text" name="sub_label[]" style="width:15%" value="" placeholder="Vietnamese"/><input id="sub_label_default_'+e+"_"+ ++t+'" type="radio" name="sub_default[]" value="'+t+'"><label for="sub_label_default_'+e+"_"+t+'">Default</label><span><label style="margin-left: 1%;">File: </label> <input type="text" name="sub_file[]" style="width:69.77%" value="" placeholder="http://example.com/files/subtitle/vietnamese.srt"/><a class="del_sub" style="padding: 4.5px 5px;top: -5px;"><span class="dashicons dashicons-no"></span></a><span class="sortable"><span class="dashicons dashicons-move"></span></span></span></div>';n("#halimmovies_listsv_"+e+"_"+s).find("#halimmovies_subs").append(i),n(".add-new-subtitle").show(),n(".list-subtitle").css("padding-bottom","30px")}),n(document).on("click",".del_sub",function(){n(this).parent().parent(".halimmovies_subs").remove()}),n(document).on("click",".add_new_listsv",function(){var e=n(this).data("server"),s=n(this).data("ep"),i='<div class="halimmovies_listsv" style="margin-bottom: 10px"><label>Name: </label> <input placeholder="Server name" type="text" name="listsv_name[]" style="width:15%" value="#" /><label>Type: </label><select name="listsv_type[]" id="listsv_type">'+episode_type+'</select><label>Link: </label> <input type="text" name="listsv_link[]" style="width:71%" value="" placeholder="Alternative video url"/><a class="del_listsv"><span class="dashicons dashicons-no"></span></a></div>';n("#halimmovies_listsv_"+e+"_"+s).find("#halimmovies_listsv").append(i),n("#add-list-sv").show()}),n(document).on("click",".del_listsv",function(){n(this).parent(".halimmovies_listsv").remove()});var e="EP 1|https://drive.google.com/file/d/1ATilCtX62rLXwpo7Gm7h2ba6wiGjbL3I/view|link \nEP 2|https://drive.google.com/file/d/1ATilCtX62rLXwpo7Gm7h2ba6wiGjbL3I/view|embed";n("textarea#import-multi-episode, #multiple-import-list, #addnewsv-list").attr("placeholder",e),n("textarea#import-multi-episode, #multiple-import-list, #addnewsv-list").focus(function(){n(this).val()===e&&n(this).attr("placeholder","")}),n("#category_select, #country_select, #release_select, #status_select, #formality_select, #orderby_select").on("change",function(){var e=n(this).val();return e&&(window.location=e),!1}),n(".publish_post").click(function(){var s=this,e=n(s).data("post-id");n(s).find(".publish-post-btn").addClass("loading"),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_publish_post",post_id:e},success:function(e){1==e.status?(n(s).find(".publish-post-btn").removeClass("dashicons-update-alt loading").addClass("dashicons-yes-alt"),n(s).parent().html("<strong>Publish</strong>")):n(s).parent().html("<strong>Error!</strong>")}})}),n("#add-server").click(function(){var e=n("#add-first-server input[name=server_name]").val(),s=n(document).find('input[name="halimmovies_ep_name[]"]').map(function(){return n(this).val()}).get(),i=n(document).find('input[name="halimmovies_ep_slug[]"]').map(function(){return n(this).val()}).get(),t=n(document).find('input[name="halimmovies_ep_link[]"]').map(function(){return n(this).val()}).get(),a=[];n('select[name="halimmovies_ep_type[]"] option:selected').each(function(){a.push(n(this).val())});var l=n(this).data("server");n("#add-server > span").removeClass("dashicons-plus").addClass("dashicons-image-rotate loading"),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_add_server",post_id:post_id,server:l,server_name:e,halimmovies_ep_name:s,halimmovies_ep_slug:i,halimmovies_ep_link:t,halimmovies_ep_type:a},success:function(e){n("#add-server > span").removeClass("dashicons-image-rotate loading").addClass("dashicons-yes"),setTimeout(function(){window.location="?page=halim-episode-manager&act=edit_ep&post_id="+post_id+"&server="+l},500)}})}),n(".del-server").click(function(){var e=n(this).data("index"),s=this;confirm("Are you sure you want to delete this server & all episodes?")&&n.ajax({type:"POST",url:ajax_url,data:{action:"halim_delete_server",post_id:post_id,server:e},success:function(e){n(s).closest(".svitem").addClass("fadeout-tomato"),n(s).closest(".svitem").fadeOut(800,function(){n(this).remove()}),setTimeout(function(){location.reload()},1500)}})}),n("#add-eps").click(function(){var e=n("input[name=halimmovies_server_name]").val(),s=n(document).find('input[name="halimmovies_ep_name[]"]').map(function(){return n(this).val()}).get(),i=n(document).find('input[name="halimmovies_ep_slug[]"]').map(function(){return n(this).val()}).get(),t=n(document).find('input[name="halimmovies_ep_link[]"]').map(function(){return n(this).val()}).get(),a=(n(document).find('input[name="episode_number[]"]').map(function(){return n(this).val()}).get(),[]);n('select[name="halimmovies_ep_type[]"] option:selected').each(function(){a.push(n(this).val())}),n("#add-eps").html("Adding..."),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_add_episode",post_id:post_id,server:server,halimmovies_server_name:e,halimmovies_ep_name:s,halimmovies_ep_slug:i,halimmovies_ep_link:t,halimmovies_ep_type:a},success:function(e){n("#add-eps").html("&#10003; Done!"),setTimeout(function(){},800)}})}),n("#update-eps").click(function(){var e=n("input[name=halimmovies_ep_name]").val(),s=n("input[name=halimmovies_ep_slug]").val(),i=n("input[name=halimmovies_ep_link]").val(),t=n('select[name="halimmovies_ep_type"] option:selected').val(),a=n("#episode_slug").data("old-ep");n("#update-eps > span").addClass("loading"),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_update_ep",server:server,post_id:post_id,ep_slug:s,ep_name:e,ep_link:i,ep_type:t,old_ep:a},success:function(e){n("#update-eps > span").removeClass("loading").addClass("dashicons-yes"),n(".disable-add-new-ep").remove()}})}),n("body").on("click",".halim-episode-saving",function(){var s=this,e=n(document).find('#list--episodes input[name="halimmovies_ep_name[]"]').map(function(){return n(this).val()}).get(),i=n(document).find('#list--episodes input[name="halimmovies_ep_slug[]"]').map(function(){return n(this).val()}).get(),t=n(document).find('#list--episodes input[name="halimmovies_ep_link[]"]').map(function(){return n(this).val()}).get(),a=n(document).find('#list--episodes input[name="halim_server_name"]').val(),l=[];n('#list--episodes select[name="halimmovies_ep_type[]"] option:selected').each(function(){l.push(n(this).val())}),n(s).html('<span class="dashicons dashicons-image-rotate loading"></span> Updating...'),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_ajax_update_ep",post_id:post_id,server:server,server_name:a,halimmovies_ep_name:e,halimmovies_ep_slug:i,halimmovies_ep_link:t,halimmovies_ep_type:l},success:function(e){n(s).html("&#10003; Done!"),setTimeout(function(){n(s).html("Update episodes")},1200)}})}),n(".update-list-sv").click(function(){var s=n(this).data("ep-slug"),e=n(document).find("#list-server-"+s).find('input[name="listsv_name[]"]').map(function(){return n(this).val()}).get(),i=n(document).find("#list-server-"+s).find('input[name="listsv_link[]"]').map(function(){return n(this).val()}).get(),t=[];n("#list-server-"+s+' select[name="listsv_type[]"] option:selected').each(function(){t.push(n(this).val())}),n(".update-list-sv").find("span."+s).addClass("loading"),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_update_listsv",post_id:post_id,server:server,episode_slug:s,listsv_name:e,listsv_link:i,listsv_type:t},success:function(e){n(".update-list-sv").find("span."+s).removeClass("loading").addClass("dashicons-yes")}})}),n("body").on("click",".update-subtitle",function(){var s=this,e=n(s).data("ep-slug"),i=n(document).find("#list-subtitle-"+e).find('input[name="sub_label[]"]').map(function(){return n(this).val()}).get(),t=n(document).find("#list-subtitle-"+e).find('input[name="sub_file[]"]').map(function(){return n(this).val()}).get(),a=n(document).find("#list-subtitle-"+e).find('input[name="sub_default[]"]:checked').map(function(){return n(this).val()}).get();n(s).html('<span class="dashicons dashicons-image-rotate loading"></span> Updating...'),n.ajax({type:"POST",url:ajax_url,data:{action:"halim_update_subtitle",post_id:post_id,server:server,episode_slug:e,sub_label:i,sub_file:t,sub_default:a},success:function(e){n(s).html("&#10003; Done!"),setTimeout(function(){n(s).html("Update")},1200)}})})}),$(".halim-list-eps, #halimmovies_listsv, #halimmovies_subs, .sortable-list-sv-box").sortable({placeholder:"slide-placeholder",axis:"y",revert:150,start:function(e,s){placeholderHeight=s.item.outerHeight(),s.placeholder.height(placeholderHeight+15),$('<div class="slide-placeholder-animator" data-height="'+placeholderHeight+'"></div>').insertAfter(s.placeholder)},change:function(e,s){s.placeholder.stop().height(0).animate({height:s.item.outerHeight()+15},300),placeholderAnimatorHeight=parseInt($(".slide-placeholder-animator").attr("data-height")),$(".slide-placeholder-animator").stop().height(placeholderAnimatorHeight+15).animate({height:0},300,function(){$(this).remove(),placeholderHeight=s.item.outerHeight(),$('<div class="slide-placeholder-animator" data-height="'+placeholderHeight+'"></div>').insertAfter(s.placeholder)})},stop:function(e,s){$(".slide-placeholder-animator").remove()}});